python，处理excel。这个excel有12万行和如下的列

股票代码 会计年度 公司类型 申请时间 发明申请A类 发明申请A类数量 发明申请B类 发明申请B类数量 发明申请C类 发明申请C类数量 发明申请D类 发明申请D类数量 发明申请E类 发明申请E类数量 发明申请F类 发明申请F类数量 发明申请G类 发明申请G类数量 发明申请H类 发明申请H类数量

我需要处理每一行的“发明申请A类”到“发明申请H类“的数据，它们都是存储的字符串。如下

{G06Q30/02(2012.01)I},{G06Q10/06(2012.01)I;G06Q20/38(2012.01)I},{G06F9/50(2006.01)I;G06F16/16(2019.01)I},{G06F16/16(2019.01)I;G06F16/176(2019.01)I},{G06F21/55(2013.01)I;G06F21/31(2013.01)I},{G06Q10/06(2012.01)I;G06Q30/06(2012.01)I},{G06Q10/10(2012.01)I;G06Q40/02(2012.01)I},{G06Q40/02(2012.01)I;G06K9/00(2006.01)I},{G06Q20/10(2012.01)I;G06Q20/38(2012.01)I;G06Q40/02(2012.01)I;G06Q40/04(2012.01)I},{G06F9/445(2018.01)I;G06F16/958(2019.01)I},{G06F16/2455(2019.01)I;G06F9/50(2006.01)I},{G06F16/74(2019.01)I;G06F16/71(2019.01)I},{G06F16/957(2019.01)I;G06F16/958(2019.01)I},{G06Q10/06(2012.01)I},{G06Q40/00(2012.01)I;G06Q20/40(2012.01)I;//(A61K31/546,31∶43)}


数据格式解释：

1. 每列的一个数据内包含多个专利，它们以","分割并以{}包裹。
2. 每个专利又包含多个专利号，以";"分割。例如{G06Q40/00(2012.01)I;G06Q20/40(2012.01)I;//(A61K31/546,31∶43)}。
    1. 普通专利号，例如G06Q40/00(2012.01)I和G06Q20/40(2012.01)I。
        1. 专利号以“/”进行分割，/前为大组，/后为小组。例如G06Q40/00(2012.01)I，其大组为G06Q40，小组为00。
        2. 大组内倒数第三个字符及其之前的字符，代表专利号的小类。例如G06Q40/00(2012.01)I，其小类为G06Q40。
    2. 特殊专利号，例如//(A61K31/546,31∶43)。它以任意字符开头（当前为//），使用()进行包裹的专利号。其/前的部分，为大组（即A61K31）。其/后的数字（当前为546,31:43），代表该专利编号为546，31，32...指导43。在统计总专利号数量时，应为1+43-31+1=14个。它代表当前的专利号本质上是14个专利号。

我需要对每行数据，汇总所有“发明申请A类”到“发明申请H类”的数据，进行3个处理
1. 数据内的所有专利号，求总数(patent_number_count)，记为p，存入列“方法1-专利号之和”；处理所有的专利号，找到它们的各个大组t（/前的部分），分别统计各个大组的数量（patent_number_count_by_group），存入列“方法1-专利大组分类计数”。最后计算专利的质量q。q=1-[(各个大组t的数量/专利号的总数p)的平方并求和]。得到最终质量q，存入列“方法1-质量q”
2. 求所有汇总的专利号的大组的去重后的数量，记为n，存入列“方法2-专利大组分类计数去重”。求所有汇总的专利号的小类的去重后的数量，记为N，存入列“方法2-专利小类分类计数去重”。计算专利质量q=N+1-1/n。得到最终质量q，存入列“方法2-质量q”
3. 求所有汇总的专利号的大组的去重后的数量，记为n，存入列“方法3-专利大组分类计数去重”。
